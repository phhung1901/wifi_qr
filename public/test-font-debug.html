<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Font Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .controls {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .form-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        button {
            background: #007aff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056cc;
        }
        .preview {
            text-align: center;
            margin: 30px 0;
        }
        canvas {
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        .font-test {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .font-sample {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”§ Font Debug Test</h1>
        <p>Debug font application in canvas</p>
        
        <div class="controls">
            <div class="form-group">
                <label>Font Family:</label>
                <select id="font-family">
                    <option value="SF Pro Display">SF Pro Display</option>
                    <option value="Arial">Arial</option>
                    <option value="Helvetica">Helvetica</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Impact">Impact</option>
                    <option value="Comic Sans MS">Comic Sans MS</option>
                    <option value="Courier New">Courier New</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Brand Name:</label>
                <input type="text" id="brand-name" value="Coffee Shop">
            </div>
            
            <div class="form-group">
                <label>WiFi Network:</label>
                <input type="text" id="wifi-name" value="CoffeeShop_WiFi">
            </div>
            
            <button onclick="testFonts()">Test Fonts</button>
            <button onclick="clearLog()">Clear Log</button>
        </div>
        
        <div class="preview">
            <h3>Canvas Test</h3>
            <canvas id="test-canvas" width="400" height="300"></canvas>
            <br>
            <button onclick="downloadTest()">Download Test</button>
        </div>
        
        <div class="font-test">
            <div class="font-sample">
                <h4>HTML Font Test</h4>
                <div id="html-sample" style="font-size: 24px; font-weight: bold;">
                    Coffee Shop<br>
                    <span style="font-size: 18px; font-weight: normal; color: #666;">CoffeeShop_WiFi</span>
                </div>
            </div>
        </div>
        
        <div class="log" id="debug-log"></div>
    </div>

    <script>
        const debugLog = document.getElementById('debug-log');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            debugLog.innerHTML += `[${timestamp}] ${message}<br>`;
            debugLog.scrollTop = debugLog.scrollHeight;
            console.log(message);
        }

        function clearLog() {
            debugLog.innerHTML = '';
        }

        function testFonts() {
            const canvas = document.getElementById('test-canvas');
            const ctx = canvas.getContext('2d');
            const selectedFont = document.getElementById('font-family').value;
            const brandName = document.getElementById('brand-name').value;
            const wifiName = document.getElementById('wifi-name').value;
            
            log(`Testing font: ${selectedFont}`);
            
            // Clear canvas
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Add border
            ctx.strokeStyle = '#e5e5e7';
            ctx.lineWidth = 1;
            ctx.strokeRect(0, 0, canvas.width, canvas.height);
            
            let currentY = 50;
            
            // Test different font string formats
            const fontFormats = [
                `bold 28px ${selectedFont}, sans-serif`,
                `bold 28px "${selectedFont}", sans-serif`,
                `bold 28px '${selectedFont}', sans-serif`,
                `bold 28px ${selectedFont.replace(/\s+/g, '')}, sans-serif`
            ];
            
            fontFormats.forEach((fontString, index) => {
                ctx.fillStyle = '#1d1d1f';
                ctx.textAlign = 'center';
                ctx.font = fontString;
                
                log(`Format ${index + 1}: ${fontString}`);
                log(`Applied font: ${ctx.font}`);
                
                ctx.fillText(`${brandName} (Format ${index + 1})`, canvas.width / 2, currentY);
                currentY += 40;
            });
            
            // Test WiFi name
            currentY += 20;
            ctx.fillStyle = '#666';
            ctx.font = `20px "${selectedFont}", sans-serif`;
            ctx.fillText(wifiName, canvas.width / 2, currentY);
            
            // Update HTML sample
            const htmlSample = document.getElementById('html-sample');
            htmlSample.style.fontFamily = `"${selectedFont}", sans-serif`;
            htmlSample.innerHTML = `${brandName}<br><span style="font-size: 18px; font-weight: normal; color: #666;">${wifiName}</span>`;
            
            log('Font test completed');
        }

        function downloadTest() {
            const canvas = document.getElementById('test-canvas');
            const selectedFont = document.getElementById('font-family').value;
            const link = document.createElement('a');
            link.download = `font-test-${selectedFont.replace(/\s+/g, '-')}.png`;
            link.href = canvas.toDataURL();
            link.click();
            log(`Downloaded test with font: ${selectedFont}`);
        }

        // Auto-test on font change
        document.getElementById('font-family').addEventListener('change', testFonts);
        document.getElementById('brand-name').addEventListener('input', testFonts);
        document.getElementById('wifi-name').addEventListener('input', testFonts);

        // Initial test
        setTimeout(testFonts, 500);
    </script>
</body>
</html>
